# **SE School BTC app**

---

Структура проєкту складається з 5 пакетів:

- **config** - тут зберігаються глобальні константи і змінні оточення.
- **data** - відповідальний за збереження і роботу з даними.Основні функції для збереження імейл адрес є у файлі `file_data_controller.go`, файл `file_utils.go` містить допоміжні функції для роботи з файлами.
- **rates** - відповідальний за отримання обмінного курсу за допомогою [Rest Coin API](https://www.coinapi.io/). Має один файл - `rate_getter.go`, у якому є універсальна функція `get_rate(currencyFrom, currencyTo)` для отримання обмінного курсу між будь-якими двома валютами, що підтримуються провайдером API, і функція `GetBtcUahRate()`, яка отримує саме курс Біткоїн/Гривня.
- **emails** - відповідальний за надсилання імейлів. Має один файл - `rate_sender.go`, у якому є загальна функція `sendEmails(addresses, message)` для надсилання імейлу зі змістом `message` на кожну із адрес списку `addresses`. Функція `SendEmailsAboutRate()` отримує поточний курс Біткоїн/Гривня, список розсилки, і надсилає цей курс на всі адреси із цього списку.
    - **smtp** - локальна версія бібліотеки `net/smtp`, зі зміненими налаштуваннями перевірки сертифікатів.
- **handlers** - сюди винесені функції, які обробляють HTTP-запити, і реєстрація цих хендлерів.

Файл `main.go` викликає загрузку змінних оточення, і запускає сервер.

Файл `.env` містить важливі змінні оточення і присутній у репозиторії тільки для того, щоб програму можна було запустити і протестувати.

У проєкті використовується лінтер-агрегатор [golangci-lint](https://github.com/golangci/golangci-lint) з кастомними налаштуваннями, які зберігаються у файлі `.golangci.yml`. Ці перевірки відбуваються автоматично за допомогою GithubActions.

Раніше при запуску через Docker функція відправлення електронних листів не працювала через неможливість перевірки сертифікатів системи. Зараз ця проблема вирішена додаванням локальної копії бібліотеки net/smtp, і внесенням у неї змін щодо дозволу надсилання листів із неперевірених пристроїв.

---

## **Docker**

Щоб запустити систему в Docker, з кореневого каталогу проєкту запустіть команди:

```go
$ docker build -t gses-app .
$ docker run -p 8080:8080 gses-app
```